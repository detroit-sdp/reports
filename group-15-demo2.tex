%% Template for SDP report, adapted from mlp_cw2_template, 2018. 

%% Based on  LaTeX template for ICML 2017 - example_paper.tex at 
%%  https://2017.icml.cc/Conferences/2017/StyleAuthorInstructions

\documentclass{article}
\input{mlp2018_includes}

%% You probably do not need to change anything above this comment

%% REPLACE the details in the following commands with your details
\setGroupNumber{15}
\setGroupName{Detroit}
\setProductName{Tadashi}
\setDemoNumber{2}
\setLogoFileName{figs/logo-small.png}

\begin{document} 

\makeSDPTitle{Demo}

\begin{abstract}
  Tadashi is an assistive robot for delivering food and water to residents in supported living and care home environments.

  In this demo, we demonstrate the robot mapping the arena using ROS; locating itself in the demo space; moving around the space while avoiding obstacles; recognizing when it is stuck; and autonomously moving from the starting location to a target location, and then returning to its original location. We will also demonstrate the lift being able to move weights of up to 1kg up and down in a stable manner. We will demonstrate the dashboard, calendar, and map pages of the app, and being able to send commands to the robot from the app. We will discuss our intended user testing and user surveys and how they will influence our future work.
\end{abstract} 

\section{Project plan update}
Our goals for this demo do not match the goals we originally set ourselves in the project plan for milestone 2. After demo 1, we decided to pivot our project work to focus exclusively on the food and water delivery system and dashboarding functionality. This meant changing our group goals to achieve this functionality, rather than tracking to the goals from our original plan. The goals we set ourselves for this sprint better match our intended `Agile' approach, as we will demonstrate a basic working product in this demo which will be iteratively improved for the next demo.

We have managed to achieve or partially achieve all the goals we set ourselves for this demo.
\begin{itemize}
\item Design and build scissor lift to lift up to 1kg: {\bf achieved}.
\item Identify and reinforce weak points in scissor lift: {\bf achieved}.
\item Mount lift to Turtlebot: {\bf partially achieved}.
\item Implement autonomous mapping and movement for the robot: {\bf achieved}.
\item Set up server to allow communication between the robot and the app: {\bf partially achieved}. 
\item Implement patient prioritization and key screens in app: calendar, map, dashboard: {\bf achieved}.
\item Plan out user testing and user surveys: {\bf achieved}.
\end{itemize}

We were not able to complete mounting the scissor lift to the robot as there has been a delay in ordering and receiving the officially-supported Turtlebot mount platforms. We expect to receive these within the next two weeks: in the meantime, we worked with the technicians to create a temporary platform using an MDF base.

We were only able to implement unidirectional (app $\rightarrow$ robot) communication, enough to allow the app to send instructions on where the robot should move to. This is because we had issues in sending packets between the app and server: we needed to wait until a network technician was available to help us resolve this issue. 


\subsection{Organization}
\begin{table}[]
  \begin{tabular}{c|c}
    Team & Members \\
    \hline
    Robot building & {\bf Jakub}, Luukas \\
    Robot programming & {\bf Ben}, Wojtek, Errikos \\
    App development & {\bf Yuchen}, Ching Ling \\
    Project management & {\bf Michael}  \\
    UI/UX and user testing & {\bf Theo}  \\
    Product development & {\bf Rebecca}  
  \end{tabular}
  \caption{New team splits across the group. Names in bold are key points of contact.}
  \label{tab:group-split}
\end{table}

At the beginning of this sprint, we rearranged group members across teams according to table \ref{tab:group-split}. Rebecca began the sprint in the robot building team, designing a CAD model of the lift, in case the Lego lift was too unstable and we needed to manufacture it instead. We found the Lego lift to be sufficiently stable, so Rebecca has moved to working on product development. Likewise Theo began the spring in the app development team, but after Yuchen and Ching Ling were able to implement key functionality, Theo moved to working on UI/UX to ensure the app would be usable by non-technical caregivers.

The entire team met once a week with our mentor to discuss group progress against goals. Michael met with each sub-team twice a week to track any possible blockers and identify any possible support they needed. Inter-team meetings were arranged ad-hoc between POCs for each team when collaboration was needed. 

Slack has been our main mode of communication, allowing for communication between team members and setting meetings. When needing to collaborate between teams, private DMs were set up with the POCs of each team to arrange meeting times. As with previous sprints, we have used GitHub to allow collaboration when writing code for the robot and the app. In writing the app, each member of the team worked on a feature branch and once work was complete, the team met to merge these branches and resolve any merge conflicts together. 

Budget spending so far consists of \pounds 1787.43 on monetary costs that come from the starting kit, so not deducted from total budget (the Turtlebot, and parts needed to make the lift); \pounds 21.59 spent on monetary costs to build the lift and prepare the arena; and 1.75 hours of technician time. This leaves us with \pounds 178.41 remaining in our budget and 5.25 hours of technician time. 

We have changed our intended goals from the original project plan, so we have decided new goals for demo 3 as below:
\begin{itemize}
\item Begin testing app with non-technical users to gain insights on accessibility and ease of use; and make changes to app justified against results of testing.
\item Complete user interviews with caregivers to assess demand for project features and implement new features based on caregiver requests. \footnote{We intend for this to be done by demo 3; however, due to UCU strike action it is possible that ethical approval will be delayed which will delay our ability to do interviews. This is outside of our control.}
\item Physically integrate lift mechanism into robot body, and integrate lift control into robot control software.
\item Design and manufacture a tray to place on top of the lift to hold items.
\item Add sensor to lift to determine whether items have been removed. 
\item Refine robot problem-solving when stuck by tuning mapping sensitivity and obstacle avoidance logic.
\item Implement bi-directional communication between the app and robot.
\end{itemize}

\section{Technical details}
\subsection{Hardware}
\begin{itemize}
\item Since we decided to make the lift out of lego deciding on the lift design was easy. The scissor lift was by far the most stable design to be made out of lego. One major factor for the lift was carry weight, so we decided to add extra gears to make sure that the lift mechanism can withstand the pressure.
\item Maximum weight identified + stress points identified--- When the lift was initially built, we quickly identified that the scissor arms were not stable . This was concluded from initial test runs that were run once the lift was built. To reinforce the lift metal rods were added to make sure that the scissor arms were stable and that chunks of lego were not disconnecting. We decided to use metal rods because they are much more stable than using the lego alternative. The rods also allowed us to save our budget instead of manufacturing lots of parts from metal.
\item  To mount the lift to the Turtlebot another platform is going to be added. The official supported platform has not arrived yet so we were not able to get the lift fixed onto the Turtlebot however, the struts the platform have been installed and a temporary platform was made with the help of the technicians.
\end{itemize}

\subsection{Software}
\begin{itemize}
\item For this milestone we have implemented Autonomous movement using Rviz and the ROS navigation stack. Rviz was used because it allows for visualising the map and plotting the goal of the Turtlebot which allowed us to work on the movement of the Turtlebot while the communication with the app was still being implemented. We also used Gazebo to create simulations of the Turtlebot to test any code we write early while we were getting connection established to the Turtlebot from a remote machine. An NTP server was also used to sync the clocks of the remote machine, that ran Rviz and the navigation packages, and the Turtlebot. This was necessary because the navigation would not run with the clocks out of sync by 0.5 milliseconds.
\item The Turtlebot also has the ability to fully map it's area. To do this we used Rviz, to visualise the map, and the lidar readings to detect any walls or obstacles. The Turtlebot can create and store a map by driving around an area manually. The code that was written in the previous demo was used to aid the manual movement for mapping an area.
\item For our final product we want an app to communicate with the Turtlebot.
The server-client connection makes use of the UDP protocol for sending and receiving packets. Each packet for movement should take the form ``GOTO [room \#]''; it will be ignored otherwise. UDP was used as there is no `handshake' required between the app and our ROS mainframe meaning that packet loss will not severely impact our performance.
\end{itemize}

\subsection{App}
\begin{itemize}
\item Implementation of key screens: calendar, map, dashboard
\item Include pictures of each screen
\item Patient prioritization
\item Possible dashboards prepared against expected use-cases: details?
\item User tests designed to evaluate usability
\end{itemize}

\subsection{User testing}
\begin{itemize}
\item Design of survey for speaking to carehome workers
\item Analysis of how survey will affect work going forward
\item Ethical approval requested (? - check with Rebecca - will be delayed with strikes)
\end{itemize}

\section{Evaluation}
Our quantitative analysis in this section concerned the functioning of the lift against use-cases. We considered the following questions:
\begin{enumerate}
\item To allow residents to pick up food and water without needing to bend down: what height can the lift reach?
\item To inform caregivers how many things can safely be put on the lift: how much weight can the robot consistently carry?
\item To estimate how long residents need to wait to pick up their delivery after the robot arrives: how long does the lift take to achieve maximum height? Is this time affected by the weight the lift is carrying?
\end{enumerate}
\begin{table}
  \begin{center}
    \begin{tabular}{lll}
      {\bf Weight (g)} & {\bf \# tests} & {\bf \# successes} \\
      \hline
      79 &   10 & 10 \\
      613 &  10 & 10 \\
      1149 & 10 & 10 \\
      1326 & 10 & 10 \\
      1682 & 10 & 10 \\
      1858 & 10 & 10 \\
      2034 & 7 & 6
    \end{tabular}
    \caption{Table showing number of times each weight was tried on the lift, and how many times the lift successfully raised and lowered the load. }
    \label{tab:weight}
  \end{center}
\end{table}

\begin{figure}
  \begin{center}
    \includegraphics[width=6cm]{figs/Lift_speed.png}
    \caption{Scatter plot showing the reciprocal relationship between the motor speed and the time taken for the lift to reach its maximum height. $n = 90$ samples for all tests. $n = 10$ samples per speed. Lift weighted at 784 grams for testing.}
  \label{fig:speed-testing}
  \end{center}
\end{figure}

\begin{figure*}
  \begin{center}
    \includegraphics[width=\linewidth]{figs/Lift_time.png}
    \caption{Box plots of the time taken for the lift to reach its maximum height with increasing weights. $n = 66$ samples for all tests. $n = 10$ samples per weight except at 2.034kg with $n = 6$.}
    \label{fig:weight-testing}
  \end{center}
\end{figure*}

To answer question 1 we measured the maximum height reached by the lift. When folded, the lift is 28cm tall. When fully extended, it is 54cm tall. When mounted on the Turtlebot, this means the lif can reach a maximum height of 71cm - sufficient to allow a resident sitting or lying down to reach the food or water delivery placed on the lift.

To answer question 2 we trialed a range of weights, checking to see if the lift could raise and lower the load successfully. We tested weights ranging from 79 grams to 2.0 kilograms, as seen in table \ref{tab:weight}. We say a lift can reliably lift the weight if it successfully raises and lowers it in all 10 trials. All weights below 2kg succeeded: at 2.0kg, the lift broke on the 7th trial and testing was halted to fix the structure. Based on this we recommend the lift be used only with weights below 2kg.

To answer question 3 we performed two tests. Firstly, we tested the variation in time taken to reach maximum height with increasing weights, from 79 grams to 2.0 kilograms (figure \ref{fig:weight-testing}). We found a statistically significant difference between the mean speed achieved by the lift with the smallest and largest weights ($p < 0.01$, $n = (10, 6)$ using a two-sample t-test), indicating that deliveries with lower weights will be delivered to residents faster. 

Secondly, we tested the time the lift with a 784 gram loads took to reach maximum height with varying speeds (200 to 1000) of the EV3 motor and calculated the mean over 10 trials for each speed. The relationship between the speed of the motor and the time the lift took to reach the height is approximately reciprocal (figure \ref{fig:speed-testing}): this is expected because speed $s$ and time $t$ have a reciprocal relationship: $s = d / t$. Based on this testing, we have chosen to proceed with a speed of 400, which is on the `elbow' of the curve and strikes a balance between the speed of the lift moving up (20.03 seconds) and the noise involved in the motors spinning quickly.



\section{Budget}
The bulk of our budget leading up to this demo has been spent on building, reinforcing, and mounting the lift. We have spent a total of \pounds 21.59 from our monetary budget and 1.75 hours of technician time. Detailed breakdowns of costs are provided in tables \ref{tab:non-budget-cost}, \ref{tab:budget-cost-monetary}, and \ref{tab:budget-cost-non-monetary}.

\begin{table}[h]
\begin{center}
    \resizebox{\columnwidth}{!}{
  \begin{tabular}{lllll}
    {\bf Item} & {\bf Units} & {\bf Cost (\pounds\ per unit)} & {\bf Total cost (\pounds)} & {\bf Use} \\
    \hline
    Turtlebot Waffle & 1 & 1275.80 & 1275.80 & Robot \\
    EV3 brick & 1 & 247.19 & 247.19 & Lift \\
    EV3 battery & 1 & 86.39 & 86.39 & Lift \\
    EV3 battery charger & 1 & 32.39 & 32.39 & Lift \\
    EV3 large motor & 2 & 32.39 & 64.78 & Lift \\
    EV3 touch sensor & 2 & 19.19 & 38.38 & Lift \\
    WiFi USB adaptor & 1 & 5.00 & 5.00 & Lift \\
    Lego & 2.5kg & 15.00 & 37.50 & Lift \\
    \hline \hline
         &       & Overall cost (\pounds) & 1787.43
  \end{tabular}}
\caption{Non-budgeted monetary costs at demo \demoNumber.}
\label{tab:non-budget-cost}
\end{center}
\end{table}

\begin{table}[h]
\begin{center}
  \resizebox{\columnwidth}{!}{
  \begin{tabular}{lllll}
    {\bf Item} & {\bf Total cost (\pounds)} & {\bf Use} \\
    \hline
    Turtlebot supports  & 8.00 & Lift \\
    MDF support (12mm x 270mm x 400mm) & 1.00  & Lift \\
    Lift support rods & 5.00 & Lift \\
    Pegboard ($0.62 \text{m}^2$ at \pounds 12 per $2.88 \text{m}^2$)& 2.59 & Arena \\
    Misc (wires, screws, angle brackets) & 5.00 & Lift, arena \\
    \hline
    \hline
     Budget spent (\pounds) & 21.59 \\
     Budget remaining (\pounds) & 178.41   
  \end{tabular}}
\caption{Budgeted monetary costs at demo \demoNumber. MDF value is approximate as 12mm MDF is not on the SDP price sheet.}
\label{tab:budget-cost-monetary}
\end{center}
\end{table}

\begin{table}[h]
\begin{center}
  \resizebox{\columnwidth}{!}{
  \begin{tabular}{lll}
    {\bf Purpose} & {\bf Hours spent} & {\bf Use} \\
    \hline
    Manufacturing lift support rods & 1 & Lift \\
    Manufacturing lift base (MDF) & 0.5 & Lift \\
    Drilling holes in lift base & 0.25 & Lift \\
    \hline
    \hline
    Overall technician hours spent & 1.75 & \\
    Total technician hours remaining & 5.25
  \end{tabular}}
\caption{Budgeted technician time at demo \demoNumber. Note that hours remaining includes subtracting any hours lost due to not being used in previous weeks.}
\label{tab:budget-cost-non-monetary}
\end{center}
\end{table}

\end{document} 

